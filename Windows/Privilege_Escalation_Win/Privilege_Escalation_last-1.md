## Windows Privilege Escalation Techniques

- **DVR4:** Leveraged an **unquoted service path / DLL hijacking** in the Argus Surveillance DVR 4.0 service. By placing a malicious `gsm_codec.dll` in the application directory, the DVR’s watchdog service (running as SYSTEM) loaded it and executed the payload​[exploit-db.com](https://www.exploit-db.com/exploits/45312#:~:text=,Affected%20Component%3A%20DVRWatchdog.exe)​[exploit-db.com](https://www.exploit-db.com/exploits/45312#:~:text=,Affected%20Component%3A%20DVRWatchdog.exe), granting SYSTEM privileges.
    
- **Monster:** Exploited a **misconfigured service** for privilege escalation. After obtaining a user shell as “Mike,” the attacker discovered a **vulnerable service running with SYSTEM privileges** that was not straightforwardly exploitable via token impersonation​[medium.com](https://medium.com/@vivek-kumar/offensive-security-proving-grounds-walk-through-monster-59a4a4283449#:~:text=Offensive%20Security%20Proving%20Grounds%20Walk,for%20SeImpersonatePrivilege%20as%20the%20golden%E2%80%A6). Instead, they modified the service’s executable (or configuration) to execute a malicious binary, resulting in Administrator-level access (the exact service vulnerability was unique to this machine’s scenario).
    
- **Fish:** Abused **weak file permissions in the SynaMan file-sharing service** (running as a privileged account). The attacker found that standard users could modify the SynaMan service executable due to insecure installation permissions. By replacing the SynaMan service binary with a malicious one and restarting the service, they achieved SYSTEM privileges​[nvd.nist.gov](https://nvd.nist.gov/vuln/detail/CVE-2022-26250#:~:text=Synaman%20v5,authenticated%20attackers%20to%20escalate%20privileges).
    
- **Steel Mountain:** Found **cleartext Administrator credentials in an unattended installation file**. The user-level shell was used to locate an `unattend.xml` file (a Windows setup file) that contained the local Administrator password in plaintext. Using these credentials, the attacker directly **logged in as Administrator**​[olivierkonate.medium.com](https://olivierkonate.medium.com/steel-mountain-tryhackme-5d0c95643e4#:~:text=2%2F%20Unquoted%20Service%20Path), achieving full privileges.
    
- **Year of the Owl:** **Recovered sensitive registry hives from the recycle bin** to escalate privileges. The user “Jareth” account had copies of the SAM and SYSTEM registry hives in the Recycle Bin. The attacker restored these files and extracted password hashes from them, obtaining the Administrator’s NTLM hash. They then cracked the hash and **impersonated the Administrator account**, granting administrative privileges​[muirlandoracle.co.uk](https://muirlandoracle.co.uk/2020/09/17/year-of-the-owl-write-up/#:~:text=Image%3A%20Jareth%27s%20recycling%20bin%20contains,hivesContents%20of%20Jareth%E2%80%99s%20Recycling%20Bin).
    
- **Retro:** Exploited a known **Windows UAC bypass (CVE-2019-1388)** to spawn an elevated command prompt. The user “Wade” had a bookmark hinting at this vulnerability​[hackingarticles.in](https://www.hackingarticles.in/retro-tryhackme-walkthrough/#:~:text=found%20a%20link%20bookmarked,We%20read%20a%20couple%20of). The attacker executed a sequence that invoked the Windows **Certificate Trust Dialog** with a high-integrity context (for example, opening a specially crafted help file or installer), bypassing User Account Control and yielding an Administrator shell.
    
- **Alfred:** Abused the **SeImpersonatePrivilege** assigned to the low-privilege user running Jenkins. After gaining an initial shell via Jenkins, the attacker used Meterpreter’s **Incognito** module to impersonate an existing NT AUTHORITY\SYSTEM token in memory​[github.com](https://github.com/Slowdeb/Tryhackme/blob/main/Alfred.md#:~:text=match%20at%20L368%20SeImpersonatePrivilege%29%20enabled,privesc%20vertically%20to%20NT%20Authority). This token impersonation (akin to _JuicyPotato_ attack) allowed the attacker to **escalate to SYSTEM** without valid Administrator credentials.
    
- **Relevant:** Took advantage of the user’s **SeImpersonatePrivilege** in conjunction with the **PrintSpoofer** exploit. With a foothold as a service account (from the SMB exploit), the attacker ran **PrintSpoofer** to create a token and communicate with the Spooler service, effectively impersonating SYSTEM​[madushan-perera.medium.com](https://madushan-perera.medium.com/tryhackme-relevant-walkthrough-6e7c83def069#:~:text=To%20perform%20privilege%20escalation%20using,%E2%80%98SeImpersonatePrivilege%2C%E2%80%99%20we%20can%20use%20PrintSpoofer). This yielded a SYSTEM-level shell.
    
- **Blueprint:** Exploited the **AlwaysInstallElevated** policy misconfiguration. Both the HKLM and HKCU registry keys were set to allow non-admin users to install MSI packages with elevated privileges. The attacker generated a malicious `.msi` file and executed it using `msiexec`, which ran with Administrative rights​[hackingarticles.in](https://www.hackingarticles.in/windows-privilege-escalation-alwaysinstallelevated/#:~:text=%E2%80%9CAlwaysInstallElevated%E2%80%9D%20is%20a%20setting%20in,those%20with%20restricted%20privileges%2C%20to). This gave the attacker a shell with **Administrator privileges**.
    
- **HackPark:** Used a **potato attack (token impersonation)** to elevate from the web application user to SYSTEM. The web app (BlogEngine) ran under an account with impersonation rights (Network Service), making it vulnerable to **JuicyPotato**. The attacker ran the JuicyPotato exploit, which exploited the system’s token delegation to spawn a shell as NT AUTHORITY\SYSTEM, thus achieving **root/Administrator access**.