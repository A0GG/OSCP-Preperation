# Privilege Escalation Techniques

- **Token Impersonation (SeImpersonate Privilege Abuse):** On several machines, the **SeImpersonatePrivilege** enabled low-privilege users to impersonate higher-privileged tokens. Exploits like **JuicyPotato**, **PrintSpoofer**, or **GodPotato** were used to spawn a SYSTEM-level process by tricking a privileged service (COM/DCOM or Print Spooler) into running a malicious program. _(Used in: Jacko, Craft, Squid, Billyboss)_
    
- **AlwaysInstallElevated Policy Misconfiguration:** A Windows policy setting that, when enabled in both **HKLM** and **HKCU**, allows any user to install Microsoft Installer packages with SYSTEM privileges. Attackers can craft a malicious `.msi` file (e.g. with a reverse shell payload) and execute it via `msiexec`, resulting in a SYSTEM shell. _(Used in: Shenzi)_
    
- **Insecure Service/Scheduled Task Permissions:** Some machines had auto-run executables (Windows services or scheduled tasks) with **weak file permissions**. A regular user could modify or replace these binaries, which are executed as SYSTEM on service start or schedule. By replacing the binary with a malicious one and triggering a restart or waiting for the schedule, attackers obtained SYSTEM privileges. _(Examples: replacing a service binary on Medjed and Hepet; hijacking a recurring scheduled task on Slort)_
    
- **Developer Backdoor Interfaces:** In one case, a hidden or **debug interface** left by developers was abused for privilege escalation. The machine had a local web endpoint that executed arbitrary commands as **SYSTEM**, intended as a “temporary command” feature. The low-privilege user leveraged this backdoor to run a reverse shell as Administrator​[routezero.security](https://routezero.security/2024/11/09/proving-grounds-practice-hepet-walkthrough/#:~:text=Team%2C). _(Used in: Nickel)_
    
- **Exploiting Unpatched OS Vulnerabilities:** Outdated Windows systems and services were vulnerable to known privilege escalation exploits. For example, one machine (AuthBy) was Windows Server 2008 vulnerable to **MS11-046** (kernel bug in AFD.sys) which was exploited via a public exploit to jump to SYSTEM​[nvd.nist.gov](https://nvd.nist.gov/vuln/detail/CVE-2011-1249#:~:text=The%20Ancillary%20Function%20Driver%20,Driver%20Elevation%20of%20Privilege%20Vulnerability). Another case involved **Task Scheduler / Service** vulnerabilities (CVE-2019-1405 and CVE-2019-1322) that allowed a **LocalService** account to gain full privileges​[exploit-db.com](https://www.exploit-db.com/exploits/47805#:~:text=This%20exploit%20uses%20two%20vulnerabilities,SYSTEM) (leveraged with the **FullPowers** tool). These known exploits were used when present on the target. _(Examples: AuthBy used a kernel exploit; Squid used FullPowers for Task Scheduler vulnerabilities)_