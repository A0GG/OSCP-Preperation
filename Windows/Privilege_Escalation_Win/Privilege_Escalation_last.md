# üîë Privilege Escalation (Machines 161‚Äì169)

- **Sudoers Misconfiguration (Missing Binary Path)** ‚Äì On **Weasel**, the user‚Äôs sudo privileges included running a non-existent binary (`/home/dev-datasci/.local/bin/jupyter`) as root without a password. The attacker exploited this by copying a shell to that path and executing it via sudo to spawn a root shell‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=cp%20%2Fbin%2Fbash%20%2Fhome%2Fdev,datasci%2F.local%2Fbin%2Fjupyter). This misconfiguration was identified by checking `sudo -l` output, and no special exploit tool was needed beyond basic Linux commands.
    
- **AlwaysInstallElevated Policy (Windows)** ‚Äì On **Weasel**, the Windows host had the **AlwaysInstallElevated** policy enabled, allowing standard users to install MSI packages with SYSTEM privileges. The attacker generated a malicious MSI payload (using `msfvenom`) and installed it via `msiexec`, resulting in a SYSTEM-level shell‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=The%20user%20%E2%80%9Cdev,Let%E2%80%99s%20give%20it%20a%20try)‚Äã[medium.com](https://medium.com/@tommasogreco/tryhackme-weasel-walkthrough-10e0d8565a28#:~:text=runas%20%2Fuser%3Adev,kb1108264.msi%20%2Fqn%E2%80%9D). The presence of this policy was discovered using a privilege escalation checker script (e.g. **PrivescCheck**), and the **msfvenom** tool was used to craft the malicious installer.
    
- **SeImpersonatePrivilege Abuse (‚ÄúPotato‚Äù Exploits)** ‚Äì On multiple Windows machines (e.g. **AllSignsPoint2Pwnage** and **VulnLab: Job/Job2**), the compromised user had the ability to impersonate tokens (SeImpersonatePrivilege). Attackers leveraged this to escalate to **NT AUTHORITY\SYSTEM** using ‚ÄúPotato‚Äù exploits. For instance, in AllSignsPoint2Pwnage the attacker ran **PrintSpoofer** (a tool exploiting SeImpersonate via the PrintSpooler service) to become SYSTEM‚Äã[github.com](https://github.com/kartikeyj96/Tryhackme-Writeups/blob/main/AllSignsPoint2Pwnage%20Writeup#:~:text=powershell%20,exe). Similarly, the **VulnLab: Job** series machines were privesced with tools like **JuicyPotato/GodPotato**, which create a rogue COM server to get a SYSTEM token‚Äã[seriotonctf.github.io](https://seriotonctf.github.io/2023/10/25/Job-Vulnlab/index.html#:~:text=Job%20is%20a%20medium%20windows,for%20Privilege%20Escalation). These attacks require an impersonation privilege and are executed with publicly available tools (PrintSpoofer, JuicyPotato, etc.).
    
- **Weak File Permissions Leading to Credential Disclosure** ‚Äì On **Anthem**, a backup file was present on the system that the low-privilege user could not initially read. However, due to permissive Access Control, the user was able to **modify the file‚Äôs permissions** (via File Properties or the `icacls` command) and then read its contents‚Äã[medium.com](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf#:~:text=So%20we%20don%E2%80%99t%20have%20permission,we%20can%20change%20those%20permissions). The backup file contained the Administrator‚Äôs password, allowing the attacker to switch to the Admin account‚Äã[medium.com](https://medium.com/@jamesjarviscyber/anthem-tryhackme-full-write-up-walkthrough-summary-28054f93c8cf#:~:text=Click%20on%20SG). No special exploit was required beyond Windows GUI or ACL tools; the key was identifying a sensitive file with misconfigured permissions.
    
- **Insecure Service Executable Permissions** ‚Äì On **Evade Smarter**, the attacker discovered a Windows service (`spoofer-scheduler`) running as SYSTEM that had its executable path in a directory writable by the user. Using manual enumeration (checking the registry and using `icacls`), they confirmed the service binary could be replaced‚Äã[medium.com](https://medium.com/@luisgerardomoret_69654/evade-smarter-tryhackme-hack-smarter-security-write-up-5b5e4f7fa1ff#:~:text=The%20spoofer,look%20like%20a%20standard%20service). The attacker built or placed a malicious executable in that path and then restarted the service to execute it as SYSTEM‚Äã[medium.com](https://medium.com/@luisgerardomoret_69654/evade-smarter-tryhackme-hack-smarter-security-write-up-5b5e4f7fa1ff#:~:text=The%20spoofer,look%20like%20a%20standard%20service). This granted a SYSTEM shell. The attack was identified by tools like **PrivescCheck** and manual reg/query commands, and exploited with basic Windows service control (`sc stop/start`) combined with a custom payload.
    
- **Stored Credentials Harvesting** ‚Äì On **Escape**, the kiosk-mode Windows system had saved credentials for an admin user (likely in RDP or another application). The attacker used **Nirsoft‚Äôs BulletsPassView** utility to recover stored passwords from memory/configuration, successfully retrieving the Administrator password‚Äã[infosecwriteups.com](https://infosecwriteups.com/escape-vulnlab-ever-heard-of-windows-kiosk-mode-no-well-its-time-to-learn-37c4d90fcacd#:~:text=match%20at%20L137%20BulletsPassView%2C%20and,was%20just%20sitting%20there%2C%20chilling). Armed with these creds, the attacker simply logged in as the admin user. In this case, privilege escalation was achieved by extracting credentials left on the machine, rather than exploiting a software flaw.
    
- **Third-Party Software Exploit (PDF24 ‚ÄúRepair‚Äù Elevation)** ‚Äì On **Lock**, the attacker abused a vulnerability in **PDF24 Creator‚Äôs** installer repair process. The PDF24 service‚Äôs repair tool (`pdf24-PrinterInstall.exe`) runs with SYSTEM rights and writes to a log file in a user-writable location. The attacker used a file-oplock tactic (via the **SetOpLock** tool) to lock the log file, causing the installer to hang and ultimately spawn an elevated command prompt‚Äã[arz101.medium.com](https://arz101.medium.com/vulnlab-lock-2cf8ae6ebe29#:~:text=access%20on,still%20remain%20open%20and%20we). Through that SYSTEM-level command window, they obtained a shell as SYSTEM. This complex method took advantage of design flaws in third-party software; the **SetOpLock** tool and knowledge of the PDF24 exploit (documented in a blog post) were crucial.
    
- **Automated Local Exploit Suggestion** ‚Äì On **CyberLens**, after obtaining a user shell, the attacker opted to run **Metasploit‚Äôs local exploit suggester** to quickly find and execute a suitable privilege escalation exploit. Metasploit identified a vulnerability on the Windows target and exploited it to grant a SYSTEM shell‚Äã[medium.com](https://medium.com/@sodahack/tryhackme-walkthrough-cyberlens-sodatex-f9b696637f05#:~:text=the%20script). (The specific exploit was not detailed by the author, as this was an automated approach.) This demonstrates using general post-exploitation tools like **WinPEAS/Seatbelt** or Metasploit modules to enumerate and exploit known privilege escalation vulnerabilities automatically.
    

---

# üìã CVE Reference Table (Machines 161‚Äì169)